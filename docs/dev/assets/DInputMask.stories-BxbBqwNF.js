import{j as ge}from"./jsx-runtime-D_zvdyIk.js";import{r as T}from"./iframe-CppG1Bu4.js";import{r as oe}from"./index-CgwUC5VX.js";import{F as Se}from"./DInput-CiZGqLt-.js";import{I as le}from"./constants-BoPmzNgw.js";function we(t,e,a){return e=U(e),(function(c,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n})(c)})(t,re()?Reflect.construct(e,a||[],U(t).constructor):e.apply(t,a))}function re(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(re=function(){return!!t})()}function ee(t){return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(t)}function Ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e,a){return Object.defineProperty(t,"prototype",{writable:!1}),t}function Ie(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},U(t)}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,c){return a.__proto__=c,a},J(t,e)}function te(t){var e=typeof Map=="function"?new Map:void 0;return te=function(a){if(a===null||!(function(o){try{return Function.toString.call(o).indexOf("[native code]")!==-1}catch{return typeof o=="function"}})(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(a))return e.get(a);e.set(a,c)}function c(){return(function(o,n,d){if(re())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var u=new(o.bind.apply(o,r));return d&&J(u,d.prototype),u})(a,arguments,U(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),J(c,a)},te(t)}var H=(function(t){function e(a,c){var o;return Ee(this,e),(o=we(this,e,[a])).name="SyntheticChangeError",o.cause=c,o}return Ie(e,t),Ve(e)})(te(Error));function xe(t,e){return T.useCallback((function(a){t.current=a,typeof e=="function"?e(a):ee(e)==="object"&&e!==null&&(e.current=a)}),[t,e])}function Q(t,e){var a=e.value,c=e.selectionStart,o=e.selectionEnd;a!==void 0&&(t.value=a),c!==void 0&&o!==void 0&&t.setSelectionRange(c,o)}var Te=["text","email","tel","search","url"];function Me(t){var e=t.init,a=t.tracking,c=t.eventType,o=t.eventHandler,n=T.useRef({timeoutId:-1,fallbackTimeoutId:-1,cachedTimeoutId:-1,start:0,end:0}),d=T.useRef(!0),r=T.useRef(null),u=T.useRef({init:e,tracking:a,eventType:c,eventHandler:o});return u.current.init=e,u.current.tracking=a,u.current.eventType=c,u.current.eventHandler=o,T.useMemo((function(){return(function(l,i,f){var p=f.onFocus,m=f.onBlur,k=f.onInput;return new Proxy(l,{set:function(V,b,s){if(b!=="current")return!1;var q=s!==null&&Te.includes(s.type);if(s!==l.current&&(l.current!==null&&(l.current.removeEventListener("focus",p),l.current.removeEventListener("blur",m),l.current.removeEventListener("input",k)),s!==null&&q)){var y,v=(y=s._wrapperState)!==null&&y!==void 0?y:{},M=v.controlled,S=M!==void 0&&M,I=v.initialValue,h=I===void 0?"":I,_=i({controlled:S,initialValue:s.value||h});Q(s,{value:_.value}),document.activeElement===s&&p(),s.addEventListener("focus",p),s.addEventListener("blur",m),s.addEventListener("input",k)}return V[b]=s,!0}})})(r,u.current.init,{onFocus:function(){n.current.timeoutId=window.setTimeout((function l(){var i,f,p,m;d.current?(n.current.start=(i=(f=r.current)===null||f===void 0?void 0:f.selectionStart)!==null&&i!==void 0?i:0,n.current.end=(p=(m=r.current)===null||m===void 0?void 0:m.selectionEnd)!==null&&p!==void 0?p:0,n.current.timeoutId=window.setTimeout(l)):n.current.fallbackTimeoutId=window.setTimeout(l)}))},onBlur:function(){window.clearTimeout(n.current.timeoutId),window.clearTimeout(n.current.fallbackTimeoutId),n.current.timeoutId=-1,n.current.fallbackTimeoutId=-1,n.current.cachedTimeoutId=-1},onInput:function(l){var i=r.current;if(i!==null)try{var f,p,m,k,V;if(n.current.cachedTimeoutId===n.current.timeoutId)throw new H("The input selection has not been updated.");n.current.cachedTimeoutId=n.current.timeoutId;var b=i.value,s=i.selectionStart,q=i.selectionEnd;if(s===null||q===null)throw new H("The selection attributes have not been initialized.");var y,v=(f=(p=i._valueTracker)===null||p===void 0||(m=p.getValue)===null||m===void 0?void 0:m.call(p))!==null&&f!==void 0?f:"";if(l.inputType===void 0&&(n.current.start=0,n.current.end=v.length),s>n.current.start?y="insert":s<=n.current.start&&s<n.current.end?y="deleteBackward":s===n.current.end&&b.length<v.length&&(y="deleteForward"),y===void 0||(y==="deleteBackward"||y==="deleteForward")&&b.length>v.length)throw new H("Input type detection error.");var M="",S="",I=n.current.start,h=n.current.end;if(y==="insert")M=b.slice(n.current.start,s);else{var _=v.length-b.length;I=s,h=s+_,S=v.slice(I,h)}var x=u.current.tracking({inputType:y,previousValue:v,value:b,addedValue:M,deletedValue:S,changeStart:I,changeEnd:h,selectionStart:s,selectionEnd:q});Q(i,{value:x.value,selectionStart:x.selectionStart,selectionEnd:x.selectionEnd});var P=u.current.eventType,$=u.current.eventHandler;if(typeof P=="string"&&$){var N=i.value,K=i.selectionStart,C=i.selectionEnd;d.current=!1,requestAnimationFrame((function(){Q(i,{value:N,selectionStart:K??N.length,selectionEnd:C??N.length});var R=new CustomEvent(P,{bubbles:!0,cancelable:!1,composed:!0,detail:x.__detail});i.dispatchEvent(R),oe.unstable_batchedUpdates?oe.unstable_batchedUpdates($,R):$(R),d.current=!0}))}(k=i._valueTracker)===null||k===void 0||(V=k.setValue)===null||V===void 0||V.call(k,v),n.current.start=x.selectionStart,n.current.end=x.selectionEnd}catch(R){var j,w,E,L,F,A,D,O,X,Y,Z,ae=R,ke=ae.name,g=ae.cause;if(Q(i,{value:(j=(w=g==null||(E=g.__attributes)===null||E===void 0?void 0:E.value)!==null&&w!==void 0?w:(L=i._valueTracker)===null||L===void 0||(F=L.getValue)===null||F===void 0?void 0:F.call(L))!==null&&j!==void 0?j:"",selectionStart:(A=g==null||(D=g.__attributes)===null||D===void 0?void 0:D.selectionStart)!==null&&A!==void 0?A:n.current.start,selectionEnd:(O=g==null||(X=g.__attributes)===null||X===void 0?void 0:X.selectionEnd)!==null&&O!==void 0?O:n.current.end}),(g==null||(Y=g.__attributes)===null||Y===void 0?void 0:Y.selectionStart)!==void 0&&(n.current.start=g.__attributes.selectionStart),(g==null||(Z=g.__attributes)===null||Z===void 0?void 0:Z.selectionEnd)!==void 0&&(n.current.end=g.__attributes.selectionEnd),l.preventDefault(),l.stopPropagation(),ke!=="SyntheticChangeError")throw R}}})}),[])}function G(t,{replacementChars:e,replacement:a,separate:c}){var d;let o=e,n="";for(const r of t){const u=!Object.prototype.hasOwnProperty.call(a,r)&&((d=a[o[0]])==null?void 0:d.test(r));(c&&r===o[0]||u)&&(o=o.slice(1),n+=r)}return n}function ie(t,e,a){const c=["[","]","\\","/","^","$",".","|","?","*","+","(",")","{","}"];let o="";for(let n=0;n<t.length;n++){const d=Object.prototype.hasOwnProperty.call(e,t[n]),r=a?`(?!${t[n]})`:"";n===0&&(o+="^"),o+=d?r+e[t[n]].toString().slice(1,-1):c.includes(t[n])?`\\${t[n]}`:t[n],n===t.length-1&&(o+="$")}return o}function Oe(t,{mask:e,replacement:a,showMask:c}){let o=(function(u,{mask:l,replacement:i}){let f=0,p="";for(const m of l)Object.prototype.hasOwnProperty.call(i,m)&&u[f]!==void 0?p+=u[f++]:p+=m;return p})(t,{mask:e,replacement:a});const n=(function(u,{mask:l,replacement:i}){return u.split("").map(((f,p)=>({type:Object.prototype.hasOwnProperty.call(i,f)?"replacement":f===l[p]?"mask":"input",value:f,index:p})))})(o,{mask:e,replacement:a});if(!c){let u=-1;for(let l=n.length-1;l>=0;l--)if(n[l].type==="input"){u=n[l].index;break}o=o.slice(0,u+1)}const d=ie(e,a,!1),r=ie(e,a,!0);return{value:o,input:t,parts:n,pattern:d,isValid:RegExp(r).test(o)}}function ue(t,{start:e=0,end:a,mask:c,replacement:o,separate:n}){const d=t.slice(e,a),r=c.slice(e,a);let u="";for(let l=0;l<r.length;l++){const i=Object.prototype.hasOwnProperty.call(o,r[l]);i&&d[l]!==void 0&&d[l]!==r[l]?u+=d[l]:i&&n&&(u+=r[l])}return u}const ce=t=>t.length>0?{[t]:/./}:{};function qe({mask:t="",replacement:e={},showMask:a=!1,separate:c=!1,modify:o,onMask:n}={}){const d=typeof e=="string"?ce(e):e,r=T.useRef(null);return Me({init:({controlled:u,initialValue:l})=>{l=u||l?l:a?t:"";const i={mask:t,replacement:d,showMask:a,separate:c};return r.current={value:l,props:i,fallbackProps:i},{value:l}},tracking:({inputType:u,previousValue:l,addedValue:i,changeStart:f,changeEnd:p})=>{if(r.current===null)throw new H("The state has not been initialized.");r.current.value!==l?r.current.props=r.current.fallbackProps:r.current.fallbackProps=r.current.props;let m=ue(l,{end:f,mask:r.current.props.mask,replacement:r.current.props.replacement,separate:r.current.props.separate});const k=RegExp(`[^${Object.keys(r.current.props.replacement).join("")}]`,"g"),V=r.current.props.mask.replace(k,"");if(m&&(m=G(m,{replacementChars:V,replacement:r.current.props.replacement,separate:r.current.props.separate})),i&&(i=G(i,{replacementChars:V.slice(m.length),replacement:r.current.props.replacement,separate:!1})),u==="insert"&&i==="")throw new H("The character does not match the key value of the `replacement` object.");let b=ue(l,{start:p,mask:r.current.props.mask,replacement:r.current.props.replacement,separate:r.current.props.separate});if(r.current.props.separate){const h=r.current.props.mask.slice(f,p).replace(k,""),_=h.length-i.length;_<0?b=b.slice(-_):_>0&&(b=h.slice(-_)+b)}b&&(b=G(b,{replacementChars:V.slice(m.length+i.length),replacement:r.current.props.replacement,separate:r.current.props.separate}));const s=m+i+b;let{mask:q=t,replacement:y=d,showMask:v=a,separate:M=c}=(o==null?void 0:o(s))??{};typeof y=="string"&&(y=ce(y));const S=Oe(s,{mask:q,replacement:y,showMask:v}),I=(function({inputType:h,value:_,addedValue:x,beforeChangeValue:P,parts:$,replacement:N,separate:K}){var F,A,D;const C=$.filter((({type:O})=>O==="input"||K&&O==="replacement")),j=(F=C[P.length+x.length-1])==null?void 0:F.index,w=(A=C[P.length-1])==null?void 0:A.index,E=(D=C[P.length+x.length])==null?void 0:D.index;if(h==="insert"){if(j!==void 0)return j+1;if(E!==void 0)return E;if(w!==void 0)return w+1}if(h==="deleteForward"){if(E!==void 0)return E;if(w!==void 0)return w+1}if(h==="deleteBackward"){if(w!==void 0)return w+1;if(E!==void 0)return E}const L=_.split("").findIndex((O=>Object.prototype.hasOwnProperty.call(N,O)));return L!==-1?L:_.length})({inputType:u,value:S.value,addedValue:i,beforeChangeValue:m,parts:S.parts,replacement:y,separate:M});return r.current.value=S.value,r.current.props={mask:q,replacement:y,showMask:v,separate:M},{value:S.value,selectionStart:I,selectionEnd:I,__detail:S}}})}const Le=T.forwardRef((function({component:t,mask:e,replacement:a,showMask:c,separate:o,modify:n,onMask:d,...r},u){const l=qe({mask:e,replacement:a,showMask:c,separate:o,modify:n,onMask:d}),i=xe(l,u);return ge.jsx(t||"input",{ref:i,...r})}));function ne(t,e){return ge.jsx(Le,{ref:e,component:Se,...t})}const _e=T.forwardRef(ne);_e.displayName="DInputMask";try{ne.displayName="DInputMask",ne.__docgenInfo={description:"",displayName:"DInputMask",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string | undefined"}},dataAttributes:{defaultValue:null,description:"",name:"dataAttributes",required:!1,type:{name:"DataAttributes | undefined"}},iconFamilyClass:{defaultValue:null,description:"",name:"iconFamilyClass",required:!1,type:{name:"string | undefined"}},iconFamilyPrefix:{defaultValue:null,description:"",name:"iconFamilyPrefix",required:!1,type:{name:"string | undefined"}},iconMaterialStyle:{defaultValue:null,description:"",name:"iconMaterialStyle",required:!1,type:{name:"boolean | undefined"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean | undefined"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"sm"'},{value:'"lg"'}]}},iconStart:{defaultValue:null,description:"",name:"iconStart",required:!1,type:{name:"string | undefined"}},iconStartDisabled:{defaultValue:null,description:"",name:"iconStartDisabled",required:!1,type:{name:"boolean | undefined"}},iconStartFamilyClass:{defaultValue:null,description:"",name:"iconStartFamilyClass",required:!1,type:{name:"string | undefined"}},iconStartFamilyPrefix:{defaultValue:null,description:"",name:"iconStartFamilyPrefix",required:!1,type:{name:"string | undefined"}},iconStartAriaLabel:{defaultValue:null,description:"",name:"iconStartAriaLabel",required:!1,type:{name:"string | undefined"}},iconStartTabIndex:{defaultValue:null,description:"",name:"iconStartTabIndex",required:!1,type:{name:"number | undefined"}},iconStartMaterialStyle:{defaultValue:null,description:"",name:"iconStartMaterialStyle",required:!1,type:{name:"boolean | undefined"}},iconEnd:{defaultValue:null,description:"",name:"iconEnd",required:!1,type:{name:"string | undefined"}},iconEndDisabled:{defaultValue:null,description:"",name:"iconEndDisabled",required:!1,type:{name:"boolean | undefined"}},iconEndFamilyClass:{defaultValue:null,description:"",name:"iconEndFamilyClass",required:!1,type:{name:"string | undefined"}},iconEndFamilyPrefix:{defaultValue:null,description:"",name:"iconEndFamilyPrefix",required:!1,type:{name:"string | undefined"}},iconEndAriaLabel:{defaultValue:null,description:"",name:"iconEndAriaLabel",required:!1,type:{name:"string | undefined"}},iconEndTabIndex:{defaultValue:null,description:"",name:"iconEndTabIndex",required:!1,type:{name:"number | undefined"}},iconEndMaterialStyle:{defaultValue:null,description:"",name:"iconEndMaterialStyle",required:!1,type:{name:"boolean | undefined"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | undefined"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string | undefined"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void) | undefined"}},hint:{defaultValue:null,description:"",name:"hint",required:!1,type:{name:"string | undefined"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean | undefined"}},valid:{defaultValue:null,description:"",name:"valid",required:!1,type:{name:"boolean | undefined"}},floatingLabel:{defaultValue:null,description:"",name:"floatingLabel",required:!1,type:{name:"boolean | undefined"}},inputStart:{defaultValue:null,description:"",name:"inputStart",required:!1,type:{name:"ReactNode"}},inputEnd:{defaultValue:null,description:"",name:"inputEnd",required:!1,type:{name:"ReactNode"}},onIconStartClick:{defaultValue:null,description:"",name:"onIconStartClick",required:!1,type:{name:"((value?: string | undefined) => void) | undefined"}},onIconEndClick:{defaultValue:null,description:"",name:"onIconEndClick",required:!1,type:{name:"((value?: string | undefined) => void) | undefined"}}}}}catch{}const Pe={title:"Design System/Components/Input Mask",component:_e,argTypes:{id:{control:"text",type:"string",description:"The id of the input"},name:{control:"text",type:"string",description:"Name of the input"},className:{control:"text",type:"string"},style:{control:"object"},label:{control:"text",type:"string"},placeholder:{control:"text",type:"string"},type:{control:"select",options:["text","email","number"],type:"string",description:"The type of the input"},value:{control:"text",type:"string",description:"The value of the input"},size:{control:{type:"select",labels:{undefined:"empty"}},type:"string",options:[void 0,"sm","lg"]},inputMode:{control:"text",type:"string",description:"Input mode"},pattern:{control:"text",type:"string",description:"Pattern to validate"},disabled:{control:"boolean",type:"boolean",table:{defaultValue:{summary:"false"}}},readOnly:{control:"boolean",type:"boolean",table:{defaultValue:{summary:"false"}}},loading:{control:"boolean",type:"boolean",table:{defaultValue:{summary:"false"}}},iconStart:{control:{type:"select",labels:{undefined:"empty"}},type:"string",options:[void 0,...le]},iconStartAriaLabel:{control:"text",type:"string"},iconEndAriaLabel:{control:"text",type:"string"},iconEnd:{control:{type:"select",labels:{undefined:"empty"}},type:"string",options:[void 0,...le]},hint:{control:"text",type:"string",description:"Hint to display, also used to display validity feedback"},invalid:{control:"boolean",type:"boolean",table:{defaultValue:{summary:"false"}}},valid:{control:"boolean",type:"boolean",table:{defaultValue:{summary:"false"}}},floatingLabel:{control:"boolean",type:"boolean",table:{defaultValue:{summary:"false"}}},onIconStartClick:{action:"onIconStartClicked"},onIconEndClick:{action:"onIconStartClicked"},mask:{control:"text",type:"string",description:"example: (+56)_ ____ ____"},replacement:{control:"object",description:"example: { _: /\\d/ }"},showMask:{control:"boolean",type:"boolean"},separate:{control:"boolean",type:"boolean"},onChange:{action:"onChange"},onBlur:{action:"onBlur"},onFocus:{action:"onFocus"},onWheel:{action:"onWheel"},onMask:{action:"onMask"},modify:{action:"modify"}}},W={args:{id:"componentId1",label:"Label",type:"text",iconStart:"Phone",iconStartAriaLabel:"start action",iconEndAriaLabel:"end action",hint:"Write your phone number",mask:"(+56)_ ____ ____",replacement:{_:/\d/},showMask:!0}},B={args:{id:"componentId2",label:"Label",type:"text",iconStart:"Phone",iconStartAriaLabel:"start action",iconEndAriaLabel:"end action",hint:"Write your phone number",mask:"(+56)_ ____ ____",replacement:{_:/\d/},showMask:!0,invalid:!0}},z={args:{id:"componentId3",label:"Label",type:"text",iconStart:"Phone",iconStartAriaLabel:"start action",iconEndAriaLabel:"end action",hint:"Write your phone number",mask:"(+56)_ ____ ____",replacement:{_:/\d/},showMask:!0,valid:!0}};var se,de,pe;W.parameters={...W.parameters,docs:{...(se=W.parameters)==null?void 0:se.docs,source:{originalSource:`{
  args: {
    id: 'componentId1',
    label: 'Label',
    type: 'text',
    iconStart: 'Phone',
    iconStartAriaLabel: 'start action',
    iconEndAriaLabel: 'end action',
    hint: 'Write your phone number',
    mask: '(+56)_ ____ ____',
    replacement: {
      _: /\\d/
    },
    showMask: true
  }
}`,...(pe=(de=W.parameters)==null?void 0:de.docs)==null?void 0:pe.source}}};var fe,me,ye;B.parameters={...B.parameters,docs:{...(fe=B.parameters)==null?void 0:fe.docs,source:{originalSource:`{
  args: {
    id: 'componentId2',
    label: 'Label',
    type: 'text',
    iconStart: 'Phone',
    iconStartAriaLabel: 'start action',
    iconEndAriaLabel: 'end action',
    hint: 'Write your phone number',
    mask: '(+56)_ ____ ____',
    replacement: {
      _: /\\d/
    },
    showMask: true,
    invalid: true
  }
}`,...(ye=(me=B.parameters)==null?void 0:me.docs)==null?void 0:ye.source}}};var be,ve,he;z.parameters={...z.parameters,docs:{...(be=z.parameters)==null?void 0:be.docs,source:{originalSource:`{
  args: {
    id: 'componentId3',
    label: 'Label',
    type: 'text',
    iconStart: 'Phone',
    iconStartAriaLabel: 'start action',
    iconEndAriaLabel: 'end action',
    hint: 'Write your phone number',
    mask: '(+56)_ ____ ____',
    replacement: {
      _: /\\d/
    },
    showMask: true,
    valid: true
  }
}`,...(he=(ve=z.parameters)==null?void 0:ve.docs)==null?void 0:he.source}}};const Ce=["Default","Invalid","Valid"],$e=Object.freeze(Object.defineProperty({__proto__:null,Default:W,Invalid:B,Valid:z,__namedExportsOrder:Ce,default:Pe},Symbol.toStringTag,{value:"Module"}));export{$e as D,_e as F,W as a};
